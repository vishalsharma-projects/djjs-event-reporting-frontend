<div class="row">
  <div class="col-12">
    <div class="page-title-box d-flex align-items-center justify-content-between">
      <h4 class="mb-0">Add User</h4>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <!-- Success Message -->
        <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
          {{ successMessage }}
          <button type="button" class="btn-close" (click)="successMessage = ''" aria-label="Close"></button>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
          {{ errorMessage }}
          <button type="button" class="btn-close" (click)="errorMessage = ''" aria-label="Close"></button>
        </div>

        <form [formGroup]="userForm" (ngSubmit)="onSubmit()">

          <div class="row mb-3">
            <!-- Name Field -->
            <div class="col-md-4">
              <label for="name" class="form-label">Name</label>
              <input 
                type="text" 
                class="form-control" 
                formControlName="name" 
                placeholder="Enter Name" 
                required 
                pattern="[a-zA-Z\s]*"
                title="Name cannot contain numbers"
              />
              <!-- Error Message for Name -->
              <div *ngIf="userForm.get('name')?.touched && userForm.get('name')?.invalid" class="text-danger">
                <small *ngIf="userForm.get('name')?.hasError('required')">Name is required.</small>
                <small *ngIf="userForm.get('name')?.hasError('numericNotAllowed')">Name cannot contain numeric characters.</small>
              </div>
            </div>

            <!-- Email Field -->
            <div class="col-md-4">
              <label for="email" class="form-label">Email</label>
              <input 
                type="email" 
                class="form-control" 
                formControlName="email" 
                placeholder="Enter Email" 
                required 
              />
              <!-- Error Message for Email -->
              <div *ngIf="userForm.get('email')?.touched && userForm.get('email')?.invalid" class="text-danger">
                <small *ngIf="userForm.get('email')?.hasError('required')">Email is required.</small>
                <small *ngIf="userForm.get('email')?.hasError('email')">Please enter a valid email.</small>
              </div>
            </div>

            <!-- Contact Number Field -->
            <div class="col-md-4">
              <label for="contact_number" class="form-label">Contact Number</label>
              <input 
                type="tel" 
                class="form-control" 
                formControlName="contact_number" 
                placeholder="Enter Contact Number (10 digits or +91XXXXXXXXXX)" 
                required 
                minlength="10"
                maxlength="13"
                pattern="(\+91[0-9]{10}|[0-9]{10})"
                title="Enter 10 digits or +91 followed by 10 digits"
              />
              <small class="form-text text-muted">Format: 10 digits (e.g., 9876543210) or +91XXXXXXXXXX</small>
              <!-- Error Message for Contact Number -->
              <div *ngIf="userForm.get('contact_number')?.touched && userForm.get('contact_number')?.invalid" class="text-danger">
                <small *ngIf="userForm.get('contact_number')?.hasError('required')">Contact Number is required.</small>
                <small *ngIf="userForm.get('contact_number')?.hasError('minlength')">Contact Number must be at least 10 digits.</small>
                <small *ngIf="userForm.get('contact_number')?.hasError('maxlength')">Contact Number cannot exceed 13 characters.</small>
                <small *ngIf="userForm.get('contact_number')?.hasError('invalidFormat')">Invalid format. Use 10 digits or +91XXXXXXXXXX.</small>
              </div>
            </div>
          </div>

          <div class="row mb-3">
            <!-- Role Field -->
            <div class="col-md-4">
              <label for="role_id" class="form-label">Role</label>
              <select 
                class="form-select" 
                formControlName="role_id" 
                required
              >
                <option value="">Select a Role</option>
                <option *ngFor="let role of roles" [value]="role.id">{{ role.name }}</option>
              </select>
              <!-- Error Message for Role -->
              <div *ngIf="userForm.get('role_id')?.touched && userForm.get('role_id')?.invalid" class="text-danger">
                <small *ngIf="userForm.get('role_id')?.hasError('required')">Role is required.</small>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12 mt-2">
              <button type="submit" class="btn btn-primary" [disabled]="userForm.invalid">
                Create User
              </button>
            </div>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>
